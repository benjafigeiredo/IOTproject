"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.logEvent = void 0;
const tslib_1 = require("tslib");
const cli_ux_1 = tslib_1.__importDefault(require("cli-ux"));
const formatTimePrefix = '%s ';
// eslint-disable-next-line @typescript-eslint/no-explicit-any
function parseEvent(event) {
    var _a;
    try {
        return JSON.parse(event.data);
    }
    catch (error) {
        cli_ux_1.default.warn(`Unable to parse received event. ${(_a = error.message) !== null && _a !== void 0 ? _a : error}`);
    }
}
function logEvent(event, formatter) {
    const sse = parseEvent(event);
    if (sse === undefined) {
        return;
    }
    const eventFormat = formatter(sse);
    const outputString = formatTimePrefix.concat(eventFormat.formatString);
    const outputArgs = eventFormat.formatArgs ? [eventFormat.time].concat(eventFormat.formatArgs) : [eventFormat.time];
    cli_ux_1.default.log(outputString, ...outputArgs);
}
exports.logEvent = logEvent;
